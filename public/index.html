<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verapp - Sistema para Gesti√≥n de Personas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Pantalla de Login -->
    <div id="login-screen" class="screen active">
        <div class="container">
            <div class="card">
                <h1>Verapp</h1>
                <p class="subtitle">Sistema para Gesti√≥n de Personas</p>
                <form id="login-form">
                    <div class="form-group">
                        <label for="usuario">Usuario:</label>
                        <input type="text" id="usuario" name="usuario" required>
                    </div>
                    <div class="form-group">
                        <label for="password">Contrase√±a:</label>
                        <input type="password" id="password" name="password" autocomplete="current-password" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Ingresar</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Pantalla Principal -->
    <div id="main-screen" class="screen">
        <!-- Overlay para cerrar el men√∫ en m√≥vil -->
        <div class="sidebar-overlay" id="sidebar-overlay"></div>
        
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <i class="fas fa-users-cog"></i>
                <h3>Verapp</h3>
            </div>
            <nav class="sidebar-nav">
                <button class="nav-item active" data-tab="dashboard">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </button>
                <button class="nav-item" data-tab="lista">
                    <i class="fas fa-users"></i>
                    <span>Personal</span>
                </button>
                <button class="nav-item" data-tab="nuevo">
                    <i class="fas fa-user-plus"></i>
                    <span>Nuevo Empleado</span>
                </button>
                <button class="nav-item" data-tab="editar" style="display:none;">
                    <i class="fas fa-user-edit"></i>
                    <span>Editar Empleado</span>
                </button>
                <button class="nav-item" data-tab="tickets">
                    <i class="fas fa-clipboard-list"></i>
                    <span>Tickets</span>
                </button>
                <button class="nav-item" data-tab="reportes">
                    <i class="fas fa-file-pdf"></i>
                    <span>Reportes</span>
                </button>
                <button class="nav-item" data-tab="alertas">
                    <i class="fas fa-bell"></i>
                    <span>Alertas</span>
                    <span id="notif-badge" class="notif-badge" style="display:none;">0</span>
                </button>
                <button class="nav-item" data-tab="auditoria">
                    <i class="fas fa-history"></i>
                    <span>Auditor√≠a</span>
                </button>
            </nav>
            <div class="sidebar-footer">
                <div class="user-info">
                    <i class="fas fa-user-circle"></i>
                    <div>
                        <div id="sidebar-user-name">Usuario</div>
                        <small>Administrador</small>
                    </div>
                </div>
                <button id="sidebar-logout-btn" class="btn-logout">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </aside>

        <!-- Toast Container -->
        <div id="toast-container"></div>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-bar">
                <button class="btn-hamburger" id="hamburger-menu" aria-label="Toggle menu">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 id="page-title"><i class="fas fa-chart-line"></i> Dashboard</h1>
                <div class="top-bar-actions">
                    <span id="role-badge" class="role-badge" style="display: none;">
                        <i class="fas fa-shield-alt"></i>
                        <span id="role-text">Usuario</span>
                    </span>
                    <button class="btn-icon" id="theme-toggle" title="Cambiar tema">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="btn-icon" title="Refrescar" onclick="location.reload()">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <button class="btn-icon" title="Ayuda">
                        <i class="fas fa-question-circle"></i>
                    </button>
                </div>
            </header>

            <!-- Tab: Dashboard -->
            <div id="tab-dashboard" class="tab-content active">
                <!-- Alertas Prioritarias - PRIMERO -->
                <div class="card">
                    <div class="alertas-header">
                        <h3><i class="fas fa-bell"></i> Alertas Prioritarias</h3>
                        <button class="btn btn-primary btn-sm" onclick="mostrarModalNuevaAlerta()">
                            <i class="fas fa-plus"></i> Nueva Alerta
                        </button>
                    </div>
                    <div id="alertas-dashboard" class="alertas-list"></div>
                </div>

                <!-- KPIs -->
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-icon" style="background: #2196f3;">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="kpi-info">
                            <h3 id="kpi-total">0</h3>
                            <p>Total Empleados</p>
                        </div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-icon" style="background: #ff9800;">
                            <i class="fas fa-globe"></i>
                        </div>
                        <div class="kpi-info">
                            <h3 id="kpi-extranjeros">0</h3>
                            <p>Extranjeros</p>
                        </div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-icon" style="background: #f44336;">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="kpi-info">
                            <h3 id="kpi-antecedentes">0</h3>
                            <p>Con Antecedentes</p>
                        </div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-icon" style="background: #9c27b0;">
                            <i class="fas fa-child"></i>
                        </div>
                        <div class="kpi-info">
                            <h3 id="kpi-menores">0</h3>
                            <p>Menores en Familias</p>
                        </div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-icon" style="background: #4caf50;">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="kpi-info">
                            <h3 id="kpi-sueldo-promedio">$0</h3>
                            <p>Sueldo Promedio</p>
                        </div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-icon" style="background: #e91e63;">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                        <div class="kpi-info">
                            <h3 id="kpi-salud">0</h3>
                            <p>Con Problemas de Salud</p>
                        </div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-icon" style="background: #00bcd4;">
                            <i class="fas fa-plane"></i>
                        </div>
                        <div class="kpi-info">
                            <h3 id="kpi-viaje">0</h3>
                            <p>De Viaje/Ausentes</p>
                        </div>
                    </div>
                </div>

                <!-- KPIs Avanzados -->
                <div class="advanced-kpis">
                    <h3 class="section-title"><i class="fas fa-chart-bar"></i> M√©tricas Avanzadas</h3>
                    <div class="kpi-grid-advanced">
                        <div class="kpi-advanced">
                            <i class="fas fa-birthday-cake"></i>
                            <div>
                                <h4 id="kpi-edad-promedio">0</h4>
                                <p>Edad Promedio</p>
                            </div>
                        </div>
                        <div class="kpi-advanced">
                            <i class="fas fa-calendar-check"></i>
                            <div>
                                <h4 id="kpi-antiguedad-promedio">0</h4>
                                <p>Antig√ºedad Promedio</p>
                            </div>
                        </div>
                        <div class="kpi-advanced">
                            <i class="fas fa-dollar-sign"></i>
                            <div>
                                <h4 id="kpi-salario-promedio">$0</h4>
                                <p>Salario Promedio</p>
                            </div>
                        </div>
                        <div class="kpi-advanced">
                            <i class="fas fa-money-bill-wave"></i>
                            <div>
                                <h4 id="kpi-costo-total">$0</h4>
                                <p>Costo Laboral Total</p>
                            </div>
                        </div>
                        <div class="kpi-advanced">
                            <i class="fas fa-users-cog"></i>
                            <div>
                                <h4 id="kpi-area-mayor">-</h4>
                                <p>√Årea con M√°s Personal</p>
                            </div>
                        </div>
                        <div class="kpi-advanced">
                            <i class="fas fa-user-graduate"></i>
                            <div>
                                <h4 id="kpi-educacion-alta">0%</h4>
                                <p>Con Estudios Superiores</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tendencias y Comparativas -->
                <div class="tendencias-section">
                    <h3 class="section-title"><i class="fas fa-chart-line"></i> Tendencias del Mes</h3>
                    <div class="tendencias-grid">
                        <div class="tendencia-card">
                            <div class="tendencia-header">
                                <i class="fas fa-user-plus"></i>
                                <span>Nuevos Ingresos</span>
                            </div>
                            <div class="tendencia-value" id="tend-ingresos">0</div>
                            <div class="tendencia-change" id="tend-ingresos-change">
                                <i class="fas fa-minus"></i> Sin cambios
                            </div>
                            <div class="tendencia-subtitle">vs mes anterior</div>
                        </div>
                        <div class="tendencia-card">
                            <div class="tendencia-header">
                                <i class="fas fa-user-minus"></i>
                                <span>Bajas</span>
                            </div>
                            <div class="tendencia-value" id="tend-bajas">0</div>
                            <div class="tendencia-change" id="tend-bajas-change">
                                <i class="fas fa-minus"></i> Sin cambios
                            </div>
                            <div class="tendencia-subtitle">vs mes anterior</div>
                        </div>
                        <div class="tendencia-card">
                            <div class="tendencia-header">
                                <i class="fas fa-chart-line"></i>
                                <span>Rotaci√≥n</span>
                            </div>
                            <div class="tendencia-value" id="tend-rotacion">0%</div>
                            <div class="tendencia-change" id="tend-rotacion-change">
                                <i class="fas fa-minus"></i> Sin cambios
                            </div>
                            <div class="tendencia-subtitle">Tasa mensual</div>
                        </div>
                        <div class="tendencia-card">
                            <div class="tendencia-header">
                                <i class="fas fa-dollar-sign"></i>
                                <span>Costo Promedio</span>
                            </div>
                            <div class="tendencia-value" id="tend-costo">$0</div>
                            <div class="tendencia-change" id="tend-costo-change">
                                <i class="fas fa-minus"></i> Sin cambios
                            </div>
                            <div class="tendencia-subtitle">vs mes anterior</div>
                        </div>
                    </div>
                </div>

                <!-- Gr√°ficos -->
                <div class="charts-grid">
                    <div class="chart-card">
                        <h3><i class="fas fa-flag"></i> Distribuci√≥n por Nacionalidad</h3>
                        <canvas id="chart-nacionalidad"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3><i class="fas fa-graduation-cap"></i> Nivel Educativo</h3>
                        <canvas id="chart-educacion"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3><i class="fas fa-id-card"></i> Tipos de Residencia</h3>
                        <canvas id="chart-residencia"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3><i class="fas fa-chart-bar"></i> Distribuci√≥n por Edad</h3>
                        <canvas id="chart-edad"></canvas>
                    </div>
                </div>
            </div>

            <!-- Tab: Lista de Empleados -->
            <div id="tab-lista" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-users"></i> Personal Registrado</h3>
                        <div class="header-actions">
                            <button class="btn btn-secondary" onclick="toggleAdvancedSearch()">
                                <i class="fas fa-filter"></i> B√∫squeda Avanzada
                            </button>
                            <button class="btn btn-primary" onclick="exportarExcel()">
                                <i class="fas fa-file-excel"></i> Exportar
                            </button>
                        </div>
                    </div>
                    
                    <!-- B√∫squeda Simple -->
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" id="search-input" placeholder="B√∫squeda r√°pida: nombre, CUIL, documento, puesto..." />
                        <button class="btn-clear" onclick="clearSearch()" title="Limpiar b√∫squeda">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <!-- B√∫squeda Avanzada (Tipo SAP/Workday) -->
                    <div id="advanced-search" class="advanced-search" style="display: none;">
                        <h4><i class="fas fa-sliders-h"></i> Filtros Avanzados</h4>
                        <div class="filters-grid">
                            <div class="filter-group">
                                <label><i class="fas fa-briefcase"></i> Puesto</label>
                                <select id="filter-puesto" onchange="applyAdvancedFilters()">
                                    <option value="">Todos los puestos</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label><i class="fas fa-building"></i> √Årea</label>
                                <select id="filter-area" onchange="applyAdvancedFilters()">
                                    <option value="">Todas las √°reas</option>
                                    <option value="Producci√≥n">Producci√≥n</option>
                                    <option value="Administraci√≥n">Administraci√≥n</option>
                                    <option value="Ventas">Ventas</option>
                                    <option value="Log√≠stica">Log√≠stica</option>
                                    <option value="Recursos Humanos">Recursos Humanos</option>
                                    <option value="Finanzas">Finanzas</option>
                                    <option value="IT/Sistemas">IT/Sistemas</option>
                                    <option value="Marketing">Marketing</option>
                                    <option value="Compras">Compras</option>
                                    <option value="Calidad">Calidad</option>
                                    <option value="Mantenimiento">Mantenimiento</option>
                                    <option value="Operaciones">Operaciones</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label><i class="fas fa-globe"></i> Nacionalidad</label>
                                <select id="filter-nacionalidad" onchange="applyAdvancedFilters()">
                                    <option value="">Todas</option>
                                    <option value="Argentina">Argentina</option>
                                    <option value="Bolivia">Bolivia</option>
                                    <option value="Brasil">Brasil</option>
                                    <option value="Chile">Chile</option>
                                    <option value="Colombia">Colombia</option>
                                    <option value="Ecuador">Ecuador</option>
                                    <option value="Paraguay">Paraguay</option>
                                    <option value="Per√∫">Per√∫</option>
                                    <option value="Uruguay">Uruguay</option>
                                    <option value="Venezuela">Venezuela</option>
                                    <option value="M√©xico">M√©xico</option>
                                    <option value="Espa√±a">Espa√±a</option>
                                    <option value="Italia">Italia</option>
                                    <option value="China">China</option>
                                    <option value="Otro">Otro</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label><i class="fas fa-graduation-cap"></i> Nivel Educativo</label>
                                <select id="filter-educacion" onchange="applyAdvancedFilters()">
                                    <option value="">Todos los niveles</option>
                                    <option value="Primario">Primario</option>
                                    <option value="Secundario">Secundario</option>
                                    <option value="Terciario">Terciario</option>
                                    <option value="Universitario">Universitario</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label><i class="fas fa-heart"></i> Estado de Salud</label>
                                <select id="filter-salud" onchange="applyAdvancedFilters()">
                                    <option value="">Todos</option>
                                    <option value="sin-problemas">Sin problemas</option>
                                    <option value="con-problemas">Con problemas de salud</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label><i class="fas fa-toggle-on"></i> Estado Laboral</label>
                                <select id="filter-estado" onchange="applyAdvancedFilters()">
                                    <option value="">Todos</option>
                                    <option value="activo">Activos</option>
                                    <option value="inactivo">Inactivos</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label><i class="fas fa-dollar-sign"></i> Rango de Salario</label>
                                <select id="filter-salario" onchange="applyAdvancedFilters()">
                                    <option value="">Todos</option>
                                    <option value="0-50000">Hasta $50,000</option>
                                    <option value="50000-100000">$50,000 - $100,000</option>
                                    <option value="100000-150000">$100,000 - $150,000</option>
                                    <option value="150000-200000">$150,000 - $200,000</option>
                                    <option value="200000+">M√°s de $200,000</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label><i class="fas fa-exclamation-triangle"></i> Antecedentes</label>
                                <select id="filter-antecedentes" onchange="applyAdvancedFilters()">
                                    <option value="">Todos</option>
                                    <option value="si">Con antecedentes</option>
                                    <option value="no">Sin antecedentes</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label><i class="fas fa-calendar"></i> Rango de Edad</label>
                                <div class="range-inputs">
                                    <input type="number" id="filter-edad-min" placeholder="Desde" min="18" max="99" onchange="applyAdvancedFilters()">
                                    <span>-</span>
                                    <input type="number" id="filter-edad-max" placeholder="Hasta" min="18" max="99" onchange="applyAdvancedFilters()">
                                </div>
                            </div>
                            <div class="filter-group">
                                <label><i class="fas fa-clock"></i> Antig√ºedad</label>
                                <select id="filter-antiguedad" onchange="applyAdvancedFilters()">
                                    <option value="">Todas</option>
                                    <option value="0-1">Menos de 1 a√±o</option>
                                    <option value="1-3">1 a 3 a√±os</option>
                                    <option value="3-5">3 a 5 a√±os</option>
                                    <option value="5+">M√°s de 5 a√±os</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label><i class="fas fa-users"></i> Con Familia</label>
                                <select id="filter-familia" onchange="applyAdvancedFilters()">
                                    <option value="">Todos</option>
                                    <option value="si">Con familiares a cargo</option>
                                    <option value="no">Sin familiares</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label><i class="fas fa-file-alt"></i> Estado de Documentos</label>
                                <select id="filter-documentos" onchange="applyAdvancedFilters()">
                                    <option value="">Todos</option>
                                    <option value="vigentes">Todos vigentes</option>
                                    <option value="por-vencer">Por vencer (30 d√≠as)</option>
                                    <option value="vencidos">Con documentos vencidos</option>
                                </select>
                            </div>
                        </div>
                        <div class="filters-actions">
                            <button class="btn btn-primary" onclick="applyAdvancedFilters()">
                                <i class="fas fa-filter"></i> Aplicar Filtros
                            </button>
                            <button class="btn btn-secondary" onclick="clearAllFilters()">
                                <i class="fas fa-eraser"></i> Limpiar Todo
                            </button>
                            <div class="filter-results" id="filter-results"></div>
                        </div>
                    </div>
                    
                    <!-- Filtros Activos -->
                    <div id="active-filters" class="active-filters" style="display: none;"></div>
                    
                    <!-- Controles de Ordenamiento -->
                    <div class="sort-controls">
                        <label><i class="fas fa-sort"></i> Ordenar por:</label>
                        <select id="sort-select" onchange="aplicarOrdenamiento()">
                            <option value="">Sin ordenar</option>
                            <option value="nombre-asc">Nombre (A-Z)</option>
                            <option value="nombre-desc">Nombre (Z-A)</option>
                            <option value="fecha-asc">Fecha Ingreso (M√°s antiguo)</option>
                            <option value="fecha-desc">Fecha Ingreso (M√°s reciente)</option>
                            <option value="salario-asc">Salario (Menor a Mayor)</option>
                            <option value="salario-desc">Salario (Mayor a Menor)</option>
                            <option value="area-asc">√Årea (A-Z)</option>
                            <option value="area-desc">√Årea (Z-A)</option>
                            <option value="edad-asc">Edad (Menor a Mayor)</option>
                            <option value="edad-desc">Edad (Mayor a Menor)</option>
                        </select>
                    </div>
                    
                    <div id="empleados-list" class="empleados-list">
                        <p class="loading">Cargando empleados...</p>
                    </div>
                </div>
            </div>

            <!-- Tab: Nuevo Empleado -->
            <div id="tab-nuevo" class="tab-content">
                <div class="card">
                    <h3><i class="fas fa-user-plus"></i> Registrar Nuevo Empleado</h3>
                    <form id="empleado-form">
                        <!-- DATOS PERSONALES -->
                        <fieldset>
                            <legend>üìã Datos Personales</legend>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="nombreCompleto">Nombre Completo *</label>
                                    <input type="text" id="nombreCompleto" required>
                                </div>
                                <div class="form-group">
                                    <label for="cuil">CUIL</label>
                                    <input type="text" id="cuil" placeholder="20123456789">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="fechaNacimiento">Fecha de Nacimiento</label>
                                    <input type="date" id="fechaNacimiento">
                                </div>
                                <div class="form-group">
                                    <label for="documento">Documento</label>
                                    <input type="text" id="documento">
                                </div>
                            </div>
                        </fieldset>

                        <!-- DATOS DE VIVIENDA -->
                        <fieldset>
                            <legend>üè† Datos de Vivienda</legend>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vivienda">Vivienda</label>
                                    <input type="text" id="vivienda" placeholder="Tipo de vivienda">
                                </div>
                                <div class="form-group">
                                    <label for="direccion">Direcci√≥n</label>
                                    <input type="text" id="direccion" placeholder="Calle, n√∫mero, localidad">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="numeroLoteInvernaculo">N√∫mero de Lote/Invernadero</label>
                                <input type="text" id="numeroLoteInvernaculo" placeholder="Ej: Lote 5, Invernadero B">
                            </div>
                        </fieldset>

                        <!-- COMPOSICI√ìN FAMILIAR -->
                        <fieldset>
                            <legend>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Composici√≥n Familiar</legend>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="estadoCivil">Estado Civil</label>
                                    <select id="estadoCivil">
                                        <option value="">Seleccionar...</option>
                                        <option value="soltero">Soltero/a</option>
                                        <option value="casado">Casado/a</option>
                                        <option value="divorciado">Divorciado/a</option>
                                        <option value="viudo">Viudo/a</option>
                                        <option value="union">Uni√≥n de hecho</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="tienePareja">¬øTiene pareja?</label>
                                    <select id="tienePareja">
                                        <option value="no">No</option>
                                        <option value="si">S√≠</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="cantidadHijos">Cantidad de Hijos</label>
                                    <input type="number" id="cantidadHijos" min="0" value="0">
                                </div>
                                <div class="form-group">
                                    <label for="hijosACargo">Hijos a Cargo</label>
                                    <input type="number" id="hijosACargo" min="0" value="0">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="hijosConviven">Hijos que Conviven</label>
                                    <input type="number" id="hijosConviven" min="0" value="0">
                                </div>
                                <div class="form-group">
                                    <label for="familiaresACargo">Otros Familiares a Cargo</label>
                                    <input type="number" id="familiaresACargo" min="0" value="0">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="escolaridadFamiliar">Observaciones de Escolaridad Familiar</label>
                                <textarea id="escolaridadFamiliar" rows="2" placeholder="Nivel educativo de los hijos o familiares..."></textarea>
                            </div>
                        </fieldset>

                        <!-- EDUCACI√ìN -->
                        <fieldset>
                            <legend>üéì Educaci√≥n</legend>
                            <div class="form-group">
                                <label for="nivelEducativo">Nivel Educativo</label>
                                <select id="nivelEducativo">
                                    <option value="">Seleccionar...</option>
                                    <option value="sin_estudios">Sin estudios</option>
                                    <option value="primario_incompleto">Primario incompleto</option>
                                    <option value="primario_completo">Primario completo</option>
                                    <option value="secundario_incompleto">Secundario incompleto</option>
                                    <option value="secundario_completo">Secundario completo</option>
                                    <option value="terciario">Terciario</option>
                                    <option value="universitario">Universitario</option>
                                </select>
                            </div>
                        </fieldset>

                        <!-- SALUD -->
                        <fieldset>
                            <legend>üè• Salud</legend>
                            <div class="form-group">
                                <label for="problemasSalud">Problemas de Salud / Observaciones</label>
                                <textarea id="problemasSalud" rows="3" placeholder="Alergias, enfermedades cr√≥nicas, discapacidades..."></textarea>
                            </div>
                        </fieldset>

                        <!-- DATOS MIGRATORIOS -->
                        <fieldset>
                            <legend>üåç Datos Migratorios</legend>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="esExtranjero">¬øEs extranjero?</label>
                                    <select id="esExtranjero">
                                        <option value="no">No</option>
                                        <option value="si">S√≠</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="paisOrigen">Pa√≠s de Origen</label>
                                    <input type="text" id="paisOrigen">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="fechaEntradaPais">Fecha de Entrada al Pa√≠s</label>
                                    <input type="date" id="fechaEntradaPais">
                                </div>
                                <div class="form-group">
                                    <label for="tipoResidencia">Tipo de Residencia</label>
                                    <select id="tipoResidencia">
                                        <option value="">Seleccionar...</option>
                                        <option value="argentino">Argentino</option>
                                        <option value="permanente">Residencia Permanente</option>
                                        <option value="temporaria">Residencia Temporaria</option>
                                        <option value="precaria">Precaria</option>
                                        <option value="turista">Turista</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="entradasSalidasPais">Registro de Entradas/Salidas del Pa√≠s</label>
                                <textarea id="entradasSalidasPais" rows="3" placeholder="Fechas de viajes, vacaciones fuera del pa√≠s..."></textarea>
                            </div>
                        </fieldset>

                        <!-- EXPERIENCIA LABORAL -->
                        <fieldset>
                            <legend>üíº Experiencia Laboral</legend>
                            <div class="form-group">
                                <label for="experienciaLaboral">Experiencia Laboral Previa</label>
                                <textarea id="experienciaLaboral" rows="4" placeholder="Empresas donde trabaj√≥, puestos, per√≠odos..."></textarea>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="fechaIngreso">Fecha de Ingreso a la Empresa</label>
                                    <input type="date" id="fechaIngreso">
                                </div>
                                <div class="form-group">
                                    <label for="puesto">Puesto Actual</label>
                                    <input type="text" id="puesto">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="sueldo">Sueldo Mensual</label>
                                <input type="number" id="sueldo" step="0.01" min="0" placeholder="Sueldo en pesos">
                            </div>
                        </fieldset>

                        <!-- ANTECEDENTES -->
                        <fieldset>
                            <legend>üìú Antecedentes</legend>
                            <div class="form-group">
                                <label for="antecedentesPenales">Antecedentes Penales</label>
                                <select id="antecedentesPenales">
                                    <option value="no">No tiene</option>
                                    <option value="si">S√≠ tiene</option>
                                    <option value="pendiente">Pendiente de verificaci√≥n</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="observacionesAntecedentes">Observaciones sobre Antecedentes</label>
                                <textarea id="observacionesAntecedentes" rows="2"></textarea>
                            </div>
                        </fieldset>

                        <!-- OBSERVACIONES GENERALES -->
                        <fieldset>
                            <legend>üìù Observaciones Generales</legend>
                            <div class="form-group">
                                <label for="observaciones">Notas adicionales</label>
                                <textarea id="observaciones" rows="3" placeholder="Cualquier informaci√≥n adicional relevante..."></textarea>
                            </div>
                        </fieldset>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">üíæ Guardar Empleado</button>
                            <button type="button" class="btn btn-secondary" onclick="resetForm()">üîÑ Limpiar</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Tab: Editar Empleado -->
            <div id="tab-editar" class="tab-content">
                <div class="card">
                    <h3><i class="fas fa-user-edit"></i> Editar Empleado <span id="edit-empleado-nombre" style="color: var(--primary);"></span></h3>
                    <form id="empleado-edit-form">
                        <!-- Mismo contenido que empleado-form pero con IDs diferentes -->
                        <!-- DATOS PERSONALES -->
                        <fieldset>
                            <legend>üìã Datos Personales</legend>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="edit-nombreCompleto">Nombre Completo *</label>
                                    <input type="text" id="edit-nombreCompleto" required>
                                </div>
                                <div class="form-group">
                                    <label for="edit-cuil">CUIL</label>
                                    <input type="text" id="edit-cuil" placeholder="20123456789">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="edit-fechaNacimiento">Fecha de Nacimiento</label>
                                    <input type="date" id="edit-fechaNacimiento">
                                </div>
                                <div class="form-group">
                                    <label for="edit-documento">Documento</label>
                                    <input type="text" id="edit-documento">
                                </div>
                            </div>
                        </fieldset>

                        <!-- DATOS DE VIVIENDA -->
                        <fieldset>
                            <legend>üè† Datos de Vivienda</legend>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="edit-vivienda">Vivienda</label>
                                    <input type="text" id="edit-vivienda" placeholder="Tipo de vivienda">
                                </div>
                                <div class="form-group">
                                    <label for="edit-direccion">Direcci√≥n</label>
                                    <input type="text" id="edit-direccion" placeholder="Calle, n√∫mero, localidad">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="edit-numeroLoteInvernaculo">N√∫mero de Lote/Invernadero</label>
                                <input type="text" id="edit-numeroLoteInvernaculo" placeholder="Ej: Lote 5, Invernadero B">
                            </div>
                        </fieldset>

                        <!-- COMPOSICI√ìN FAMILIAR -->
                        <fieldset>
                            <legend>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Composici√≥n Familiar</legend>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="edit-estadoCivil">Estado Civil</label>
                                    <select id="edit-estadoCivil">
                                        <option value="">Seleccionar...</option>
                                        <option value="soltero">Soltero/a</option>
                                        <option value="casado">Casado/a</option>
                                        <option value="divorciado">Divorciado/a</option>
                                        <option value="viudo">Viudo/a</option>
                                        <option value="union">Uni√≥n de hecho</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="edit-tienePareja">¬øTiene pareja?</label>
                                    <select id="edit-tienePareja">
                                        <option value="no">No</option>
                                        <option value="si">S√≠</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="edit-cantidadHijos">Cantidad de Hijos</label>
                                    <input type="number" id="edit-cantidadHijos" min="0" value="0">
                                </div>
                                <div class="form-group">
                                    <label for="edit-hijosACargo">Hijos a Cargo</label>
                                    <input type="number" id="edit-hijosACargo" min="0" value="0">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="edit-hijosConviven">Hijos que Conviven</label>
                                    <input type="number" id="edit-hijosConviven" min="0" value="0">
                                </div>
                                <div class="form-group">
                                    <label for="edit-familiaresACargo">Otros Familiares a Cargo</label>
                                    <input type="number" id="edit-familiaresACargo" min="0" value="0">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="edit-escolaridadFamiliar">Observaciones de Escolaridad Familiar</label>
                                <textarea id="edit-escolaridadFamiliar" rows="2" placeholder="Nivel educativo de los hijos o familiares..."></textarea>
                            </div>
                        </fieldset>

                        <!-- EDUCACI√ìN -->
                        <fieldset>
                            <legend>üéì Educaci√≥n</legend>
                            <div class="form-group">
                                <label for="edit-nivelEducativo">Nivel Educativo</label>
                                <select id="edit-nivelEducativo">
                                    <option value="">Seleccionar...</option>
                                    <option value="sin_estudios">Sin estudios</option>
                                    <option value="primario_incompleto">Primario incompleto</option>
                                    <option value="primario_completo">Primario completo</option>
                                    <option value="secundario_incompleto">Secundario incompleto</option>
                                    <option value="secundario_completo">Secundario completo</option>
                                    <option value="terciario">Terciario</option>
                                    <option value="universitario">Universitario</option>
                                </select>
                            </div>
                        </fieldset>

                        <!-- SALUD -->
                        <fieldset>
                            <legend>üè≠ Salud</legend>
                            <div class="form-group">
                                <label for="edit-problemasSalud">Problemas de Salud / Observaciones</label>
                                <textarea id="edit-problemasSalud" rows="3" placeholder="Alergias, enfermedades cr√≥nicas, discapacidades..."></textarea>
                            </div>
                        </fieldset>

                        <!-- DATOS MIGRATORIOS -->
                        <fieldset>
                            <legend>üåç Datos Migratorios</legend>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="edit-esExtranjero">¬øEs extranjero?</label>
                                    <select id="edit-esExtranjero">
                                        <option value="no">No</option>
                                        <option value="si">S√≠</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="edit-paisOrigen">Pa√≠s de Origen</label>
                                    <input type="text" id="edit-paisOrigen">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="edit-fechaEntradaPais">Fecha de Entrada al Pa√≠s</label>
                                    <input type="date" id="edit-fechaEntradaPais">
                                </div>
                                <div class="form-group">
                                    <label for="edit-tipoResidencia">Tipo de Residencia</label>
                                    <select id="edit-tipoResidencia">
                                        <option value="">Seleccionar...</option>
                                        <option value="argentino">Argentino</option>
                                        <option value="permanente">Residencia Permanente</option>
                                        <option value="temporaria">Residencia Temporaria</option>
                                        <option value="precaria">Precaria</option>
                                        <option value="turista">Turista</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="edit-entradasSalidasPais">Registro de Entradas/Salidas del Pa√≠s</label>
                                <textarea id="edit-entradasSalidasPais" rows="3" placeholder="Fechas de viajes, vacaciones fuera del pa√≠s..."></textarea>
                            </div>
                        </fieldset>

                        <!-- EXPERIENCIA LABORAL -->
                        <fieldset>
                            <legend>üíº Experiencia Laboral</legend>
                            <div class="form-group">
                                <label for="edit-experienciaLaboral">Experiencia Laboral Previa</label>
                                <textarea id="edit-experienciaLaboral" rows="4" placeholder="Empresas donde trabaj√≥, puestos, per√≠odos..."></textarea>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="edit-fechaIngreso">Fecha de Ingreso a la Empresa</label>
                                    <input type="date" id="edit-fechaIngreso">
                                </div>
                                <div class="form-group">
                                    <label for="edit-puesto">Puesto Actual</label>
                                    <input type="text" id="edit-puesto">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="edit-sueldo">Sueldo Mensual</label>
                                <input type="number" id="edit-sueldo" step="0.01" min="0" placeholder="Sueldo en pesos">
                            </div>
                        </fieldset>

                        <!-- ANTECEDENTES -->
                        <fieldset>
                            <legend>üìú Antecedentes</legend>
                            <div class="form-group">
                                <label for="edit-antecedentesPenales">Antecedentes Penales</label>
                                <select id="edit-antecedentesPenales">
                                    <option value="no">No tiene</option>
                                    <option value="si">S√≠ tiene</option>
                                    <option value="pendiente">Pendiente de verificaci√≥n</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="edit-observacionesAntecedentes">Observaciones sobre Antecedentes</label>
                                <textarea id="edit-observacionesAntecedentes" rows="2"></textarea>
                            </div>
                        </fieldset>

                        <!-- OBSERVACIONES GENERALES -->
                        <fieldset>
                            <legend>üìù Observaciones Generales</legend>
                            <div class="form-group">
                                <label for="edit-observaciones">Notas adicionales</label>
                                <textarea id="edit-observaciones" rows="3" placeholder="Cualquier informaci√≥n adicional relevante..."></textarea>
                            </div>
                        </fieldset>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">üíæ Actualizar Empleado</button>
                            <button type="button" class="btn btn-secondary" onclick="cancelarEdicion()">‚ùå Cancelar</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Tab: Tickets -->
            <div id="tab-tickets" class="tab-content">
                <!-- Estad√≠sticas de Tickets -->
                <div class="tickets-stats-grid">
                    <div class="stat-card-mini stat-pendientes">
                        <i class="fas fa-clock"></i>
                        <div>
                            <h3 id="stat-tickets-pendientes">0</h3>
                            <p>Pendientes</p>
                        </div>
                    </div>
                    <div class="stat-card-mini stat-aprobados">
                        <i class="fas fa-check-circle"></i>
                        <div>
                            <h3 id="stat-tickets-aprobados">0</h3>
                            <p>Aprobados</p>
                        </div>
                    </div>
                    <div class="stat-card-mini stat-proceso">
                        <i class="fas fa-spinner"></i>
                        <div>
                            <h3 id="stat-tickets-proceso">0</h3>
                            <p>En Proceso</p>
                        </div>
                    </div>
                    <div class="stat-card-mini stat-ausentes">
                        <i class="fas fa-plane-departure"></i>
                        <div>
                            <h3 id="stat-empleados-ausentes">0</h3>
                            <p>Ausentes Hoy</p>
                        </div>
                    </div>
                </div>

                <!-- Pesta√±as de Tickets -->
                <div class="card">
                    <div class="tickets-header">
                        <h3><i class="fas fa-clipboard-list"></i> Gesti√≥n de Tickets</h3>
                        <button class="btn btn-primary" onclick="mostrarModalNuevoTicket()">
                            <i class="fas fa-plus"></i> Nuevo Ticket
                        </button>
                    </div>

                    <div class="tickets-tabs">
                        <button class="ticket-tab-btn active" data-tickettab="todos">Todos</button>
                        <button class="ticket-tab-btn" data-tickettab="pendientes">Pendientes</button>
                        <button class="ticket-tab-btn" data-tickettab="ausentes">Ausentes Hoy</button>
                        <button class="ticket-tab-btn" data-tickettab="vacaciones">Vacaciones</button>
                        <button class="ticket-tab-btn" data-tickettab="cambios">Cambios</button>
                    </div>

                    <!-- Filtros de Tickets -->
                    <div class="tickets-filters">
                        <input type="text" id="ticket-search" placeholder="üîç Buscar por empleado, tipo o t√≠tulo..." onkeyup="filtrarTickets()">
                        <select id="ticket-filter-estado" onchange="filtrarTickets()">
                            <option value="">Todos los estados</option>
                            <option value="pendiente">Pendientes</option>
                            <option value="aprobado">Aprobados</option>
                            <option value="rechazado">Rechazados</option>
                            <option value="en_proceso">En Proceso</option>
                            <option value="completado">Completados</option>
                            <option value="cancelado">Cancelados</option>
                        </select>
                        <select id="ticket-filter-tipo" onchange="filtrarTickets()">
                            <option value="">Todos los tipos</option>
                            <option value="vacaciones">Vacaciones</option>
                            <option value="viaje">Viaje</option>
                            <option value="licencia_medica">Licencia M√©dica</option>
                            <option value="licencia_maternidad">Maternidad/Paternidad</option>
                            <option value="cambio_puesto">Cambio de Puesto</option>
                            <option value="cambio_area">Cambio de √Årea</option>
                            <option value="cambio_salario">Cambio de Salario</option>
                            <option value="cambio_personal">Cambio Personal</option>
                            <option value="capacitacion">Capacitaci√≥n</option>
                            <option value="reconocimiento">Reconocimiento</option>
                            <option value="desvinculacion">Desvinculaci√≥n</option>
                            <option value="otro">Otro</option>
                        </select>
                    </div>

                    <!-- Lista de Tickets -->
                    <div id="tickets-list" class="tickets-list">
                        <p class="loading">Cargando tickets...</p>
                    </div>
                </div>

                <!-- Empleados Ausentes -->
                <div class="card" id="ausentes-card">
                    <h3><i class="fas fa-calendar-times"></i> Empleados Ausentes Hoy</h3>
                    <div id="empleados-ausentes-list" class="ausentes-list">
                        <p class="loading">Cargando...</p>
                    </div>
                </div>
            </div>

            <!-- Tab: Reportes -->
            <div id="tab-reportes" class="tab-content">
                <div class="reports-header">
                    <h2><i class="fas fa-file-alt"></i> Centro de Reportes</h2>
                    <div class="reports-header-actions">
                        <button class="btn btn-success" onclick="exportarAExcelMejorado()">
                            <i class="fas fa-file-excel"></i> Exportar Excel Completo
                        </button>
                        <button class="btn btn-primary" onclick="exportarAPDF()">
                            <i class="fas fa-file-pdf"></i> Exportar PDF
                        </button>
                        <button class="btn btn-warning" onclick="exportarBackup()">
                            <i class="fas fa-download"></i> Backup Completo
                        </button>
                        <button class="btn btn-secondary" onclick="document.getElementById('import-file').click()">
                            <i class="fas fa-upload"></i> Importar Datos
                        </button>
                        <input type="file" id="import-file" accept=".json" style="display: none;" onchange="importarBackup(event)">
                    </div>
                </div>
                
                <div class="reports-grid">
                    <div class="report-card" onclick="generarReporte('general')">
                        <i class="fas fa-file-alt"></i>
                        <h4>Reporte General</h4>
                        <p>Todos los empleados con informaci√≥n completa</p>
                    </div>
                    <div class="report-card" onclick="generarReporte('extranjeros')">
                        <i class="fas fa-globe"></i>
                        <h4>Personal Extranjero</h4>
                        <p>Listado de empleados extranjeros y sus residencias</p>
                    </div>
                    <div class="report-card" onclick="generarReporte('antecedentes')">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h4>Con Antecedentes</h4>
                        <p>Empleados con antecedentes penales</p>
                    </div>
                    <div class="report-card" onclick="generarReporte('salud')">
                        <i class="fas fa-heartbeat"></i>
                        <h4>Problemas de Salud</h4>
                        <p>Personal con condiciones de salud registradas</p>
                    </div>
                    <div class="report-card" onclick="generarReporte('familias')">
                        <i class="fas fa-child"></i>
                        <h4>Composici√≥n Familiar</h4>
                        <p>An√°lisis demogr√°fico de familias y menores</p>
                    </div>
                    <div class="report-card" onclick="generarReporte('educacion')">
                        <i class="fas fa-graduation-cap"></i>
                        <h4>Nivel Educativo</h4>
                        <p>Estad√≠sticas de educaci√≥n del personal</p>
                    </div>
                </div>
            </div>

            <!-- Tab: Alertas -->
            <div id="tab-alertas" class="tab-content">
                <div class="card">
                    <div class="alertas-header">
                        <h3><i class="fas fa-bell"></i> Alertas y Notificaciones</h3>
                        <button class="btn btn-primary" onclick="mostrarModalNuevaAlerta()">
                            <i class="fas fa-plus"></i> Nueva Alerta
                        </button>
                    </div>
                    <div class="alertas-tabs">
                        <button class="alerta-tab-btn active" data-alerta="todas">Todas</button>
                        <button class="alerta-tab-btn" data-alerta="criticas">Cr√≠ticas</button>
                        <button class="alerta-tab-btn" data-alerta="migratorio">Migratorio</button>
                        <button class="alerta-tab-btn" data-alerta="salud">Salud</button>
                        <button class="alerta-tab-btn" data-alerta="avisos">Avisos</button>
                    </div>
                    <div id="alertas-list" class="alertas-list"></div>
                </div>
                
                <!-- Secci√≥n de Auditor√≠a -->
                <div class="card">
                    <h3><i class="fas fa-history"></i> Auditor√≠a del Sistema</h3>
                    <div class="auditoria-filters">
                        <select id="auditoria-usuario" onchange="loadAuditoria()">
                            <option value="">Todos los usuarios</option>
                        </select>
                        <select id="auditoria-accion" onchange="loadAuditoria()">
                            <option value="">Todas las acciones</option>
                            <option value="creado">Creado</option>
                            <option value="editado">Editado</option>
                            <option value="eliminado">Eliminado</option>
                            <option value="aprobado">Aprobado</option>
                            <option value="rechazado">Rechazado</option>
                        </select>
                        <input type="date" id="auditoria-fecha" onchange="loadAuditoria()">
                    </div>
                    <div id="auditoria-list" class="auditoria-list">
                        <p class="loading">Cargando auditor√≠a...</p>
                    </div>
                </div>
            </div>

            <!-- Tab: Auditor√≠a -->
            <div id="tab-auditoria" class="tab-content">
                <div class="card">
                    <h3><i class="fas fa-history"></i> Registro de Actividades</h3>
                    <div class="auditoria-filters">
                        <select id="auditoria-usuario-filter">
                            <option value="">Todos los usuarios</option>
                        </select>
                        <select id="auditoria-accion-filter">
                            <option value="">Todas las acciones</option>
                            <option value="crear">Crear</option>
                            <option value="editar">Editar</option>
                            <option value="eliminar">Eliminar</option>
                            <option value="aprobar">Aprobar</option>
                            <option value="rechazar">Rechazar</option>
                        </select>
                        <input type="date" id="auditoria-fecha-filter" placeholder="Filtrar por fecha">
                        <button class="btn btn-secondary" onclick="filtrarAuditoria()">
                            <i class="fas fa-filter"></i> Filtrar
                        </button>
                        <button class="btn btn-secondary" onclick="limpiarFiltrosAuditoria()">
                            <i class="fas fa-times"></i> Limpiar
                        </button>
                    </div>
                    <div id="auditoria-list" class="auditoria-list">
                        <p class="loading">Cargando actividades...</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal: Ver Perfil Completo del Empleado -->
    <div id="modal-perfil" class="modal">
        <div class="modal-content">
            <div class="modal-header-perfil">
                <span class="modal-close">&times;</span>
                <button class="btn btn-primary" onclick="imprimirPerfil()">
                    <i class="fas fa-print"></i> Imprimir
                </button>
            </div>
            <div id="perfil-content"></div>
        </div>
    </div>

    <!-- Modal: Crear/Editar Ticket -->
    <div id="modal-ticket" class="modal">
        <div class="modal-content modal-large">
            <span class="modal-close-ticket">&times;</span>
            <h3 id="ticket-modal-title">üìã Crear Nuevo Ticket</h3>
            <form id="ticket-form">
                <input type="hidden" id="ticket-id">
                <input type="hidden" id="ticket-empleadoId">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="ticket-empleado-select">Empleado *</label>
                        <select id="ticket-empleado-select" required>
                            <option value="">Seleccionar empleado...</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="ticket-tipo">Tipo de Ticket *</label>
                        <select id="ticket-tipo" required onchange="adaptarFormularioTicket()">
                            <option value="">Seleccionar tipo...</option>
                            <optgroup label="Ausencias">
                                <option value="vacaciones">üèñÔ∏è Vacaciones</option>
                                <option value="licencia_medica">üè• Licencia M√©dica</option>
                                <option value="licencia_maternidad">üë∂ Licencia Maternidad/Paternidad</option>
                                <option value="permiso">üìã Permiso Temporal</option>
                                <option value="suspension">‚ö†Ô∏è Suspensi√≥n</option>
                            </optgroup>
                            <optgroup label="Cambios Laborales">
                                <option value="cambio_puesto">üìà Cambio de Puesto</option>
                                <option value="cambio_area">üè¢ Cambio de √Årea</option>
                                <option value="cambio_salario">üí∞ Cambio de Salario</option>
                                <option value="desvinculacion">üö™ Desvinculaci√≥n</option>
                                <option value="reincorporacion">‚Ü©Ô∏è Reincorporaci√≥n</option>
                            </optgroup>
                            <optgroup label="Eventos">
                                <option value="viaje">‚úàÔ∏è Viaje</option>
                                <option value="cambio_personal">üë®‚Äçüë©‚Äçüëß Cambio Personal</option>
                                <option value="capacitacion">üìö Capacitaci√≥n</option>
                                <option value="reconocimiento">üèÜ Reconocimiento</option>
                                <option value="amonestacion">‚ö†Ô∏è Amonestaci√≥n</option>
                            </optgroup>
                            <option value="otro">üìù Otro</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="ticket-titulo">T√≠tulo *</label>
                    <input type="text" id="ticket-titulo" required placeholder="Ej: Vacaciones de verano, Promoci√≥n a Senior, etc.">
                </div>

                <div class="form-group">
                    <label for="ticket-descripcion">Descripci√≥n</label>
                    <textarea id="ticket-descripcion" rows="3" placeholder="Detalles adicionales..."></textarea>
                </div>

                <!-- Campos din√°micos seg√∫n tipo -->
                <div id="ticket-campos-periodo" style="display:none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="ticket-fecha-desde">Fecha Desde *</label>
                            <input type="date" id="ticket-fecha-desde">
                        </div>
                        <div class="form-group">
                            <label for="ticket-fecha-hasta">Fecha Hasta *</label>
                            <input type="date" id="ticket-fecha-hasta">
                        </div>
                    </div>
                </div>

                <div id="ticket-campos-evento" style="display:none;">
                    <div class="form-group">
                        <label for="ticket-fecha-evento">Fecha del Evento *</label>
                        <input type="date" id="ticket-fecha-evento">
                    </div>
                </div>

                <div id="ticket-campos-cambio" style="display:none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="ticket-valor-anterior">Valor Anterior</label>
                            <input type="text" id="ticket-valor-anterior" placeholder="Valor actual">
                        </div>
                        <div class="form-group">
                            <label for="ticket-valor-nuevo">Valor Nuevo *</label>
                            <input type="text" id="ticket-valor-nuevo" placeholder="Nuevo valor">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="ticket-actualiza-empleado">
                            Actualizar autom√°ticamente los datos del empleado al aprobar
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="ticket-observaciones">Observaciones</label>
                    <textarea id="ticket-observaciones" rows="2" placeholder="Notas adicionales..."></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="ticket-estado">Estado</label>
                        <select id="ticket-estado">
                            <option value="pendiente">‚è≥ Pendiente</option>
                            <option value="aprobado">‚úÖ Aprobado</option>
                            <option value="rechazado">‚ùå Rechazado</option>
                            <option value="en_proceso">üîÑ En Proceso</option>
                            <option value="completado">‚úîÔ∏è Completado</option>
                            <option value="cancelado">üö´ Cancelado</option>
                        </select>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">üíæ Guardar Ticket</button>
                    <button type="button" class="btn btn-secondary" onclick="closeTicketModal()">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Detalle del Ticket -->
    <div id="modal-ticket-detalle" class="modal">
        <div class="modal-content modal-medium">
            <span class="modal-close" onclick="closeTicketDetalleModal()">&times;</span>
            <div id="ticket-detalle-content"></div>
        </div>
    </div>

    <!-- Modal: Nueva Alerta -->
    <div id="modal-alerta" class="modal">
        <div class="modal-content modal-medium">
            <span class="modal-close" onclick="closeAlertaModal()">&times;</span>
            <h3>üîî Crear Nueva Alerta</h3>
            <form id="alerta-form">
                <div class="form-group">
                    <label for="alerta-empleado">Empleado (opcional)</label>
                    <select id="alerta-empleado">
                        <option value="">Alerta general del sistema</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="alerta-tipo">Tipo de Alerta *</label>
                    <select id="alerta-tipo" required>
                        <option value="">Seleccionar tipo...</option>
                        <option value="vacaciones">üèñÔ∏è Solicitud de Vacaciones</option>
                        <option value="permiso">üìã Solicitud de Permiso</option>
                        <option value="licencia">üè• Solicitud de Licencia</option>
                        <option value="vencimiento">‚è∞ Vencimiento de Documento</option>
                        <option value="cumplea√±os">üéÇ Cumplea√±os</option>
                        <option value="aniversario">üéâ Aniversario</option>
                        <option value="recordatorio">üìå Recordatorio General</option>
                        <option value="urgente">üö® Urgente</option>
                        <option value="info">‚ÑπÔ∏è Informativo</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="alerta-titulo">T√≠tulo *</label>
                    <input type="text" id="alerta-titulo" required placeholder="T√≠tulo de la alerta">
                </div>
                <div class="form-group">
                    <label for="alerta-mensaje">Mensaje *</label>
                    <textarea id="alerta-mensaje" rows="4" required placeholder="Descripci√≥n detallada de la alerta..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="alerta-fecha">Fecha de la Alerta</label>
                        <input type="date" id="alerta-fecha">
                    </div>
                    <div class="form-group">
                        <label for="alerta-fecha-vencimiento">Fecha de Vencimiento</label>
                        <input type="date" id="alerta-fecha-vencimiento">
                    </div>
                </div>
                <div class="form-group">
                    <label for="alerta-prioridad">Prioridad</label>
                    <select id="alerta-prioridad">
                        <option value="baja">Baja</option>
                        <option value="media" selected>Media</option>
                        <option value="alta">Alta</option>
                        <option value="critica">Cr√≠tica</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">üíæ Guardar Alerta</button>
                    <button type="button" class="btn btn-secondary" onclick="closeAlertaModal()">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- jsPDF Libraries for PDF Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <!-- SheetJS for Excel Export -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
